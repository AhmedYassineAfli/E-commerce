<div class="report-container">
    <div class="report-header">
        <h1>⚠️ Signaler un problème</h1>
        <p>Commande #{{ order?.id }}</p>
    </div>

    <div *ngIf="isLoading" class="loading">
        <div class="spinner"></div>
        <p>Chargement...</p>
    </div>

    <div *ngIf="!isLoading && order" class="report-content">
        <!-- Order Summary -->
        <div class="order-summary">
            <h3>Articles concernés</h3>
            <div class="items-list">
                <div *ngFor="let item of order.orderItems" class="item">
                    <img [src]="item.product.imageUrl" [alt]="item.product.designation">
                    <div class="item-info">
                        <p class="name">{{ item.product.designation }}</p>
                        <p class="qty">Qté: {{ item.quantity }}</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Report Form -->
        <div class="report-form">
            <div class="form-group">
                <label for="reason">Raison du signalement</label>
                <select id="reason" [(ngModel)]="reason" class="form-control">
                    <option value="" disabled selected>Sélectionnez une raison</option>
                    <option *ngFor="let r of reasons" [value]="r">{{ r }}</option>
                </select>
            </div>

            <div class="form-group">
                <label for="description">Description détaillée</label>
                <textarea id="description" [(ngModel)]="description" rows="4"
                    placeholder="Expliquez le problème en détail..." class="form-control"></textarea>
            </div>

            <div class="form-group">
                <label>Preuve (Photo obligatoire)</label>
                <div class="image-upload-container">
                    <input type="file" (change)="onFileSelected($event)" accept="image/*" id="fileInput" hidden>
                    <label for="fileInput" class="upload-btn">
                        <i class="fas fa-camera"></i>
                        {{ selectedImage ? 'Changer la photo' : 'Prendre/Choisir une photo' }}
                    </label>

                    <div *ngIf="selectedImage" class="image-preview">
                        <img [src]="selectedImage" alt="Preuve">
                    </div>
                </div>
            </div>

            <div class="form-actions">
                <button (click)="onSubmit()" [disabled]="isSubmitting" class="btn-submit">
                    {{ isSubmitting ? 'Envoi en cours...' : 'Envoyer le signalement' }}
                </button>
            </div>
        </div>
    </div>
</div>